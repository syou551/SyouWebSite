import * as dntShim from "../../_dnt.shims.js";
import { load as loadConfig } from "../shared/config.js";
import { archiveExistingChallengeFiles, downloadChallengeFilesTo, getCommonChallengeContext, trackClientFromConfig, } from "../shared/mod.js";
export async function reset() {
    const config = await loadConfig();
    const api = trackClientFromConfig(config);
    const [_codingContext, _challenge] = await getCommonChallengeContext(config, api);
    console.log("Your existing code will be archived in this directory and the original challenge code will be downloaded");
    const shouldContinue = dntShim.confirm("Are you sure you want to reset this challenge?");
    if (!shouldContinue) {
        return;
    }
    const currentDir = dntShim.Deno.cwd();
    await archiveExistingChallengeFiles(config.orgName);
    await api.reset();
    const newCodingContext = await api.context();
    const showFileDiff = false;
    const includeTarball = true;
    await downloadChallengeFilesTo(newCodingContext, currentDir, api, showFileDiff, includeTarball);
}
