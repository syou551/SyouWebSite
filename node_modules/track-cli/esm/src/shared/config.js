import * as dntShim from "../../_dnt.shims.js";
import { MissingConfigFile } from "./errors.js";
import { ensureFile } from "../../deps/deno.land/std@0.195.0/fs/ensure_file.js";
export const CONFIG_FILE_PATH = ".track/config.json";
export async function save(config, options) {
    const jsonStr = JSON.stringify(config, null, 2);
    const configFilePath = options?.path ?? CONFIG_FILE_PATH;
    await ensureFile(configFilePath);
    await dntShim.Deno.writeFile(configFilePath, new TextEncoder().encode(jsonStr));
}
export async function load(options) {
    let data;
    try {
        data = await dntShim.Deno.readFile(options?.path ?? CONFIG_FILE_PATH);
    }
    catch (_e) {
        throw new MissingConfigFile();
    }
    const configStr = new TextDecoder().decode(data);
    return JSON.parse(configStr);
}
